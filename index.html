<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trening z pomiarów odległości</title>
  <style>
    body {
      font-family: "SF Mono", "Roboto Mono", Menlo, Monaco, Consolas, "Courier New", monospace;
      margin: 0;
      padding: 0;
      background-color: #000000;
      color: #21d8c5;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    h1 {
      color: #21d8c5;
      margin: 20px 0;
      font-size: 2rem;
    }

    .container {
      display: flex;
      flex-wrap: wrap;
      max-width: 1200px;
      width: 100%;
      gap: 20px;
      justify-content: center;
      background-color: #000000;

    }

    .column-a {
      position: relative;
      flex-shrink: 0;
      flex-grow: 1;
      min-width: 400px;
      min-height: auto;
      max-width: 900px;
      max-height: 900px;
      width: auto;
      aspect-ratio: 1; /* Proporcje 1:1 */
      background-color: #000000;
      border: 0px solid #3c3c3c;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
    }

    .column-a img {
      position: absolute;
      min-width: 400px;
      min-height: auto;
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      aspect-ratio: 1; /* Proporcje 1:1 */
    }

    .mildot-overlay {
      display: none; /* Ukryj na początku */
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 9999; /* Priorytet */
      pointer-events: none;
      aspect-ratio: 1; /* Proporcje 1:1 */

    }

    .column-b {
      width: auto;
      min-width: 200px;
      padding: 20px;
      background-color: #000000;
      border: 0px solid #3c3c3c;
      border-radius: 20px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
      flex-grow: 1;
    }

    .form-group {
      margin-bottom: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    select, input[type="number"] {
      width: 300px;
      padding: 10px;
      font-size: 16px;
      background-color: #05242b;
      border: 0px solid #3c3c3c;
      border-radius: 20px;
      color: #21d8c5;
      box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
    }

    select:focus, input[type="number"]:focus {
      outline: none;
      border-color: #61dafb;
      box-shadow: 0 0 5px #61dafb;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      background-color: #05242b;
      color: #21d8c5;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #2b645e;
    }

    #result-message {
      margin-top: 20px;
      font-size: 16px;
      color: #21d8c5;
      text-align: left;
    }

    @media (max-width: 768px) {
      .container {
        flex-direction: column;
      }

      .column-a {
        order: -1; /* Kolumna A wyżej na mobilkach */
        width: 100%;
      }

      .column-b {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <h1>Zmierz odległość do celu</h1>
  <div class="container">
    <!-- Kolumna A -->
   <div class="column column-a">
  <!-- Wyświetlanie wideo -->
  <video id="video-display" class="mildot-overlay" autoplay muted loop hidden>
    <source id="video-source" src="" type="video/mp4">
    Twój przeglądarka nie obsługuje elementu wideo.
  </video>

  <!-- Siatka Mildot -->
  <img id="mildot-overlay" class="mildot-overlay" src="img/siatka-mildot.png" alt="Siatka Mildot">

  <!-- Obrazek -->
  <img id="image-display" src="img/logo.jpg" alt="Logo">

  <!-- Wybór poziomu trudności -->
  <select id="difficulty-select">
    <option value="basic">Podstawowy</option>
    <option value="medium">Średni</option>
    <option value="advanced">Zaawansowany</option>
  </select>

  <!-- Pole do wpisania odległości -->
  <input id="distance-input" type="number" placeholder="Podaj odległość" />

  <!-- Przycisk zatwierdzenia -->
  <button id="submit-distance">Zatwierdź</button>

  <!-- Komunikaty wyników -->
  <p id="result-message"></p>
  <p id="countdown-timer"></p>
</div>

  </div>
<script>
// Elementy DOM
const difficultySelect = document.getElementById("difficulty-select");
const imageDisplay = document.getElementById("image-display");
const videoDisplay = document.getElementById("video-display");
const mildotOverlay = document.getElementById("mildot-overlay");
const submitDistanceButton = document.getElementById("submit-distance");
const distanceInput = document.getElementById("distance-input");
const resultMessage = document.getElementById("result-message");
const countdownTimer = document.getElementById("countdown-timer");

// Wartości ustawione na poziomach trudności
const imageFolders = {
  basic: "img/basic/",
  medium: "img/medium/",
  advanced: "img/advanced/"
};

// Listy plików do poziomów trudności
const imageList = {
  basic: ["target_100.jpg", "target_200.jpg"],
  medium: ["target_300.jpg", "target_400.jpg"],
  advanced: ["target_500.jpg", "target_600.jpg", "video1.mp4", "video2.mp4"]
};

// Zmienna do odliczania czasu
let countdownInterval;
let timeRemaining = 0;
let correctDistance = 0;

// Funkcja losująca obrazek
function getRandomImage(level) {
  const images = imageList[level].filter(file => file.endsWith(".jpg"));
  return images[Math.floor(Math.random() * images.length)];
}

// Funkcja losująca wideo
function getRandomVideo() {
  const videos = imageList.advanced.filter(file => file.endsWith(".mp4"));
  return videos[Math.floor(Math.random() * videos.length)];
}

// Funkcja do wyświetlania losowego obrazu lub wideo
function updateAdvancedDisplay() {
  const randomChoice = Math.random() < 0.5 ? "video" : "image"; // 50/50 szansa
  if (randomChoice === "video") {
    const randomVideo = getRandomVideo();
    if (randomVideo) {
      document.getElementById("video-source").src = imageFolders.advanced + randomVideo;
      videoDisplay.load();
      videoDisplay.hidden = false;
      imageDisplay.hidden = true;
      videoDisplay.play();
    }
  } else {
    const randomImage = getRandomImage("advanced");
    if (randomImage) {
      imageDisplay.src = imageFolders.advanced + randomImage;
      imageDisplay.alt = randomImage;
      imageDisplay.hidden = false;
      videoDisplay.hidden = true;
      videoDisplay.pause();
    }
  }
}

// Funkcja zmieniająca wyświetlony obrazek lub wideo w zależności od poziomu trudności
function updateDisplay(level) {
  if (level === "advanced") {
    updateAdvancedDisplay();
  } else {
    const randomImage = getRandomImage(level);
    if (randomImage) {
      imageDisplay.src = imageFolders[level] + randomImage;
      imageDisplay.alt = randomImage;
      imageDisplay.hidden = false;
      videoDisplay.hidden = true;
      videoDisplay.pause();
    }
  }
}

// Obsługuje zmianę poziomu trudności
difficultySelect.addEventListener("change", () => {
  const level = difficultySelect.value;
  if (level) {
    clearInterval(countdownInterval); // Reset odliczania
    updateDisplay(level); // Wyświetl obrazek lub wideo
    startCountdown(level); // Rozpocznij odliczanie
  }
});

// Funkcja do uruchamiania odliczania
function startCountdown(level) {
  switch (level) {
    case "basic":
      timeRemaining = 120; // 2 minuty
      break;
    case "medium":
      timeRemaining = 60; // 1 minuta
      break;
    case "advanced":
      timeRemaining = 30; // 30 sekund
      break;
    default:
      return;
  }
  updateCountdownDisplay();
  countdownInterval = setInterval(() => {
    timeRemaining--;
    updateCountdownDisplay();
    if (timeRemaining <= 0) {
      clearInterval(countdownInterval);
      resultMessage.textContent = `Czas minął! Prawidłowa odległość to ${correctDistance} metrów.`;
      videoDisplay.pause();
    }
  }, 1000);
}

// Funkcja do aktualizacji wyświetlania czasu
function updateCountdownDisplay() {
  countdownTimer.textContent = `Pozostały czas: ${timeRemaining} sekund`;
}

// Obsługuje przycisk zatwierdzenia
submitDistanceButton.addEventListener("click", () => {
  videoDisplay.pause();
  const userDistance = parseInt(distanceInput.value, 10);
  const errorMargin = 5; // Granica błędu wynosząca ±5 metrów
  if (isWithinErrorMargin(userDistance, correctDistance, errorMargin)) {
    resultMessage.textContent = `Gratulacje! Trafiłeś w granicach błędu. Prawidłowa odległość to ${correctDistance} metrów.`;
  } else {
    resultMessage.textContent = `Niepoprawne. Prawidłowa odległość to ${correctDistance} metrów.`;
  }
  distanceInput.value = "";
});

// Funkcja sprawdzająca, czy wartość jest w granicach błędu
function isWithinErrorMargin(value, target, margin) {
  return Math.abs(value - target) <= margin;
}

</script>

</body>
</html>
